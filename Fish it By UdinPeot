-- Fishing Auto GUI v2
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Buat ScreenGui
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local Title = Instance.new("TextLabel")
local AutoButton = Instance.new("TextButton")
local SpeedLabel = Instance.new("TextLabel")
local SpeedTextBox = Instance.new("TextBox")
local StatusLabel = Instance.new("TextLabel")
local CloseButton = Instance.new("TextButton")

-- Variabel
local autoActive = false
local completionSpeed = 0.5

-- Setup GUI
ScreenGui.Parent = game:GetService("CoreGui")
ScreenGui.Name = "FishingAutoGUI"
ScreenGui.ResetOnSpawn = false

-- Main Frame
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
MainFrame.BorderSizePixel = 0
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -120)
MainFrame.Size = UDim2.new(0, 300, 0, 240)
MainFrame.Active = true
MainFrame.Draggable = true
local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 10)
MainCorner.Parent = MainFrame

-- Title
Title.Parent = MainFrame
Title.BackgroundTransparency = 1
Title.Position = UDim2.new(0, 0, 0, 0)
Title.Size = UDim2.new(1, 0, 0, 40)
Title.Font = Enum.Font.GothamBold
Title.Text = "üé£ Fishing Auto v2"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 18

-- Close Button
CloseButton.Parent = MainFrame
CloseButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
CloseButton.BorderSizePixel = 0
CloseButton.Position = UDim2.new(1, -35, 0, 5)
CloseButton.Size = UDim2.new(0, 30, 0, 30)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.Text = "X"
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.TextSize = 16
local CloseCorner = Instance.new("UICorner")
CloseCorner.CornerRadius = UDim.new(0, 8)
CloseCorner.Parent = CloseButton

-- Auto Button
AutoButton.Parent = MainFrame
AutoButton.BackgroundColor3 = Color3.fromRGB(200, 100, 100)
AutoButton.BorderSizePixel = 0
AutoButton.Position = UDim2.new(0.1, 0, 0, 50)
AutoButton.Size = UDim2.new(0.8, 0, 0, 50)
AutoButton.Font = Enum.Font.GothamBold
AutoButton.Text = "üîÑ START AUTO FISHING"
AutoButton.TextColor3 = Color3.fromRGB(255, 255, 255)
AutoButton.TextSize = 16
local AutoCorner = Instance.new("UICorner")
AutoCorner.CornerRadius = UDim.new(0, 8)
AutoCorner.Parent = AutoButton

-- Speed Label
SpeedLabel.Parent = MainFrame
SpeedLabel.BackgroundTransparency = 1
SpeedLabel.Position = UDim2.new(0.1, 0, 0, 115)
SpeedLabel.Size = UDim2.new(0.8, 0, 0, 20)
SpeedLabel.Font = Enum.Font.Gotham
SpeedLabel.Text = "Kecepatan Complete (detik):"
SpeedLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
SpeedLabel.TextSize = 12
SpeedLabel.TextXAlignment = Enum.TextXAlignment.Left

-- Speed TextBox
SpeedTextBox.Parent = MainFrame
SpeedTextBox.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
SpeedTextBox.BorderSizePixel = 0
SpeedTextBox.Position = UDim2.new(0.1, 0, 0, 140)
SpeedTextBox.Size = UDim2.new(0.8, 0, 0, 35)
SpeedTextBox.Font = Enum.Font.GothamBold
SpeedTextBox.Text = "0.5"
SpeedTextBox.TextColor3 = Color3.fromRGB(100, 200, 255)
SpeedTextBox.TextSize = 16
SpeedTextBox.PlaceholderText = "0.5"
local SpeedCorner = Instance.new("UICorner")
SpeedCorner.CornerRadius = UDim.new(0, 8)
SpeedCorner.Parent = SpeedTextBox

-- Status Label
StatusLabel.Parent = MainFrame
StatusLabel.BackgroundTransparency = 1
StatusLabel.Position = UDim2.new(0.1, 0, 0, 185)
StatusLabel.Size = UDim2.new(0.8, 0, 0, 40)
StatusLabel.Font = Enum.Font.Gotham
StatusLabel.Text = "Status: Siap"
StatusLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
StatusLabel.TextSize = 12
StatusLabel.TextWrapped = true

-- Fungsi Script 1: Charge Fishing Rod
local function chargeFishingRod()
    local success, err = pcall(function()
        ReplicatedStorage:WaitForChild("Packages"):WaitForChild("_Index"):WaitForChild("sleitnick_net@0.2.0"):WaitForChild("net"):WaitForChild("RF/ChargeFishingRod"):InvokeServer()
    end)
    if success then
        print("‚úÖ Fishing Rod Charged!")
        return true
    else
        warn("‚ùå Error charging rod:", err)
        return false
    end
end

-- Fungsi Script 2: Start Minigame
local function startMinigame()
    local success, err = pcall(function()
        local args = {
            -286.5379638671875,
            0.9836857009746349,
            1764308253.78425
        }
        ReplicatedStorage:WaitForChild("Packages"):WaitForChild("_Index"):WaitForChild("sleitnick_net@0.2.0"):WaitForChild("net"):WaitForChild("RF/RequestFishingMinigameStarted"):InvokeServer(unpack(args))
    end)
    if success then
        print("‚úÖ Minigame Started!")
        return true
    else
        warn("‚ùå Error starting minigame:", err)
        return false
    end
end

-- Fungsi Script 3: Complete Fishing
local function completeFishing()
    local success, err = pcall(function()
        ReplicatedStorage:WaitForChild("Packages"):WaitForChild("_Index"):WaitForChild("sleitnick_net@0.2.0"):WaitForChild("net"):WaitForChild("RE/FishingCompleted"):FireServer()
    end)
    if success then
        print("‚úÖ Fishing Completed!")
        return true
    else
        warn("‚ùå Error completing fishing:", err)
        return false
    end
end

-- Fungsi Auto Fishing Loop
local function autoFishingLoop()
    while autoActive do
        StatusLabel.Text = "‚ö° Charging rod..."
        StatusLabel.TextColor3 = Color3.fromRGB(255, 200, 100)
        
        -- Script 1: Charge
        chargeFishingRod()
        wait(0.3)
        
        StatusLabel.Text = "üéÆ Starting minigame..."
        StatusLabel.TextColor3 = Color3.fromRGB(255, 200, 100)
        
        -- Script 2: Start Minigame
        startMinigame()
        
        -- Tunggu sesuai kecepatan
        StatusLabel.Text = "‚è≥ Menunggu " .. completionSpeed .. " detik..."
        StatusLabel.TextColor3 = Color3.fromRGB(100, 200, 255)
        wait(completionSpeed)
        
        -- Script 3: Complete
        StatusLabel.Text = "‚úì Completing..."
        StatusLabel.TextColor3 = Color3.fromRGB(255, 200, 100)
        completeFishing()
        
        StatusLabel.Text = "‚úÖ Cycle completed!"
        StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
        wait(0.5)
    end
    StatusLabel.Text = "Status: Auto dihentikan"
    StatusLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
end

-- Update kecepatan dari TextBox
SpeedTextBox.FocusLost:Connect(function()
    local inputValue = tonumber(SpeedTextBox.Text)
    if inputValue and inputValue > 0 then
        completionSpeed = inputValue
        print("‚úÖ Kecepatan diatur: " .. completionSpeed .. " detik")
    else
        SpeedTextBox.Text = tostring(completionSpeed)
        warn("‚ö†Ô∏è Input tidak valid!")
    end
end)

-- Toggle Auto Button (FIXED)
AutoButton.MouseButton1Click:Connect(function()
    print("Button clicked! Current state:", autoActive)
    
    autoActive = not autoActive
    
    if autoActive then
        print("‚úÖ AUTO FISHING DIAKTIFKAN")
        AutoButton.Text = "üõë STOP AUTO FISHING"
        AutoButton.BackgroundColor3 = Color3.fromRGB(100, 200, 100)
        StatusLabel.Text = "‚úÖ Auto Fishing AKTIF"
        StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
        
        -- Jalankan loop di thread terpisah
        task.spawn(autoFishingLoop)
    else
        print("‚ùå AUTO FISHING DIMATIKAN")
        AutoButton.Text = "üîÑ START AUTO FISHING"
        AutoButton.BackgroundColor3 = Color3.fromRGB(200, 100, 100)
        StatusLabel.Text = "Status: Auto dihentikan"
        StatusLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
    end
end)

-- Close Button
CloseButton.MouseButton1Click:Connect(function()
    print("Closing GUI...")
    autoActive = false
    ScreenGui:Destroy()
end)

-- Test tombol dengan print
print("üé£ Fishing Auto GUI v2 Loaded!")
print("Klik tombol untuk test - akan muncul print di console")
print("AutoButton MouseButton1Click connected:", AutoButton.MouseButton1Click ~= nil)
